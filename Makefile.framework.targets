include Makefile.framework

FRAMEWORKSRC = src/framework/core/entity.cpp \
	src/framework/core/util.cpp \
	src/framework/core/environment.cpp \
	src/framework/core/screen.cpp \
	src/framework/core/screenbuckettree.cpp \
	src/framework/geom/region.cpp \
	src/framework/geom/point.cpp \
	src/framework/geom/util.cpp \
	src/framework/core/blockbundle.cpp \
	src/framework/core/background.cpp \
	src/framework/core/entity-exit.cpp \
	src/framework/core/displayadapter.cpp \
	src/framework/core/level.cpp \
	src/framework/core/resourcemanager.cpp \
	src/framework/core/resource-entity.cpp \
	src/framework/core/entityspawner.cpp \
	src/framework/core/inputadapter.cpp \
	src/framework/core/game.cpp \
	src/framework/core/resource-level.cpp \
	src/framework/debug/d123.cpp

FRAMEWORKOBJ = obj/framework/core/entity.o \
	obj/framework/core/util.o \
	obj/framework/core/environment.o \
	obj/framework/core/screen.o \
	obj/framework/core/screenbuckettree.o \
	obj/framework/geom/region.o \
	obj/framework/geom/point.o \
	obj/framework/geom/util.o \
	obj/framework/core/blockbundle.o \
	obj/framework/core/background.o \
	obj/framework/core/entity-exit.o \
	obj/framework/core/displayadapter.o \
	obj/framework/core/level.o \
	obj/framework/core/resourcemanager.o \
	obj/framework/core/resource-entity.o \
	obj/framework/core/entityspawner.o \
	obj/framework/core/inputadapter.o \
	obj/framework/core/game.o \
	obj/framework/core/resource-level.o \
	obj/framework/debug/d123.o

framework-dist: framework-lib
	mkdir -p dist/inc/core dist/inc/geom dist/inc/debug dist/lib
	cp lib/libcruftybehemoth.so dist/lib/
	cp src/framework/core/*.h dist/inc/core/
	cp src/framework/geom/*.h dist/inc/geom/
	cp src/framework/debug/*.h dist/inc/debug/
	tar cvjf dist/cruftybehemoth-`cat version`.tbz -Cdist/ --exclude=*.tbz .

framework-lib: framework
	mkdir -p lib
	$(CC) -shared $(LDFLAGS) -o lib/libcruftybehemoth.so $(FRAMEWORKOBJ)

framework: $(FRAMEWORKSRC)
	mkdir -p obj/framework/core
	mkdir -p obj/framework/geom
	mkdir -p obj/framework/debug
	$(CC) $(CFLAGS) -o obj/framework/core/entity.o src/framework/core/entity.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/util.o src/framework/core/util.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/environment.o src/framework/core/environment.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/screen.o src/framework/core/screen.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/screenbuckettree.o src/framework/core/screenbuckettree.cpp
	$(CC) $(CFLAGS) -o obj/framework/geom/region.o src/framework/geom/region.cpp
	$(CC) $(CFLAGS) -o obj/framework/geom/point.o src/framework/geom/point.cpp
	$(CC) $(CFLAGS) -o obj/framework/geom/util.o src/framework/geom/util.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/blockbundle.o src/framework/core/blockbundle.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/background.o src/framework/core/background.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/entity-exit.o src/framework/core/entity-exit.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/displayadapter.o src/framework/core/displayadapter.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/level.o src/framework/core/level.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/resourcemanager.o src/framework/core/resourcemanager.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/resource-entity.o src/framework/core/resource-entity.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/entityspawner.o src/framework/core/entityspawner.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/inputadapter.o src/framework/core/inputadapter.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/game.o src/framework/core/game.cpp
	$(CC) $(CFLAGS) -o obj/framework/core/resource-level.o src/framework/core/resource-level.cpp
	$(CC) $(CFLAGS) -o obj/framework/debug/d123.o src/framework/debug/d123.cpp

clean:
	rm -rf bin obj lib dist
